Ip作为整个TCP/IP中至关重要的协议，主要负责将数据包发送给最终的目标计算机。因此，IP能够让世界上任何两台计算机之间进行通信。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/ISO%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B.png)


# IP即网际协议

TCP/IP的心脏是互联网层。这一层主要由IP(Internet Protocol)和ICMP(Internet Control Message Protocol)两个协议组成。

## IP相当于OSI参考模型中的第3层

IP相当于OSI参考模型中的第3层——网络层。

网络层的主要作用是“实现终端节点之间的通信”。这种终端节点之间的通信也叫“点对点(end-to-end)通信”。

从前面的张杰可知，网络层的下一层——数据链路层的主要作用是在互连同一种数据链路的节点之间进行包传递。而一旦跨越多种数据链路，就需要借助网络层。网络层可以跨越不同的数据链路，即使是在不同的数据链路上也能实现两端节点之间的数据包传输。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter04/1_IP%E7%9A%84%E4%BD%9C%E7%94%A8.png)

### 主机和节点

在互联网世界中，将那些配有IP地址的设备叫做“主机”。这里的主机可以是超大型计算机，也可以是小型计算机。习惯上将配有IP地址的设备称为“主机”。  
然而，准确地说，主机的定义应该是指“配置有IP地址，但是不进行路由控制的设备”。既配有IP地址又具有路由控制能力的设备叫做“路由器”，跟主机有所区别。而节点则是主机和路由器的统称。

## 网络层与数据链路层的关系

数据链路层提供直连的两个设备之间的通信功能。与之相比，作为网络层的IP则负责在没有直连的两个网络之间进行通信传输。  
用旅行为例说明这个问题。有个人要去一个很远的地方旅行，并且计划先后乘坐飞机、火车、公交车到达目的地。为此，他决定先去旅行社购买机票和火车票。  
旅行社不仅为他预定好了旅途过程中所需要的机票和火车票，甚至为他指定了一个详细行程表，详细到几点积分需要乘坐飞机或火车都一目了然。  
当然，机票和火车票只有特定区间内有效，当你换乘不同公司的飞机或火车时，还需要重新购票。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter04/2_IP%E7%9A%84%E4%BD%9C%E7%94%A8%E4%B8%8E%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E7%9A%84%E4%BD%9C%E7%94%A8.png)

仔细分析一下机票和火车票，不难发现，每张票只能在某一限定区间内移动。此处的“区间内”就如同通信网络上的数据链路。而这个区间内的出发地点和目的地点就如同某一个数据链路的源地址和目标地址等首部信息。整个全程的行程表的作用就相当于网络层。  
如果我们只有行程表而没有车票，就无法搭乘交通工具到达目的地。反之，如果除了车票其他什么都没有，恐怕也很难到达目的地。因为你不知道该坐陈么车，也不知道该在哪里换乘。因此，只有两者兼备，既有某个区间的车票又有整个旅行的行程表，才能保证到达目的地。与之类似，计算机网络中也需要数据链路层和网络层这个分层才能实现向最终目标地址的通信。
