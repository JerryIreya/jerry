![https://raw.githubusercontent.com/JerryIreya/Image/master/ISO%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B.png](https://raw.githubusercontent.com/JerryIreya/Image/master/ISO%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B.png)

# 从独立模式到网络互联模式

起初，计算机是作为单机模式广泛使用(也被称为独立模式)，随着计算机的不断发展，人们将计算机连接在一起，形成网络互联模式。 **连接多台计算机可以实现信息共享，同时还能在两台物理位置较远的机器之间即时传递信息**


以独立模式使用计算机：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%8B%AC%E7%AB%8B%E6%A8%A1%E5%BC%8F.png)

以网络互联模式使用计算机：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_2_%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BA%92%E8%81%94%E6%A8%A1%E5%BC%8F.png)


计算机网络，根据其规模可分为WAN(Wide Area Network,广域网)和LAN(Local Area Network,局域网)

LAN:

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_3_LAN.png)


WAN:

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_4_WAN.png)


# 计算机与网络发展的7个阶段

## 1. 批处理

为了能让更多的人使用计算机，出现了批处理(Batch Processing)系统。所谓批处理，是指实现将用户程序和数据装入卡带或磁带，并由计算机按照一定的顺序读取，使用户所要执行的这些程序和数据能够一并批量得到处理的方式。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_5_%E6%89%B9%E5%A4%84%E7%90%86.png)

当时的计算机操作起来相当复杂，不是所有人都能够轻松自如地使用。因此在实际运行程序时通常会交给专门的操作员去处理。有时程序处理时间较长，在用户较多的情况下，用户程序可能无法立即得到运行。这时用户只能将程序留给操作员，过些时日再来计算机中心取结果。

## 2.分时系统

继批处理系统之后，出现了分时系统。它是指多个终端与同一个计算机连接，允许多个用户同时使用一台计算机的系统。

分时系统：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_6_%E5%88%86%E6%97%B6%E7%B3%BB%E7%BB%9F.png)

## 3. 计算机之间的通信

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_7_%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1.png)

计算机间的通信显著地提高了计算机的可用性。人们不再局限于仅使用一台计算机进行处理，而是逐渐使用多台计算机 **分布式处理** ,最终一并得到返回结果。


## 4. 计算机网络的产生

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_8_%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.png)

人们开始实验基于 **分组交换** 技术的计算机网络，并着手研究不同厂商的计算机之间相互通信的技术。一种能够互连多种计算机的网络随之诞生。它能够让各式各样的计算机相互连接，从大型的超级计算机或主机到小型的个人电脑。


## 5. 互联网的普及

个人电脑的普及以及万维网等信息传播方式如雨后春笋般迎来了前所未有的发展，使得互联网从大到整个公司范围小到每个家庭内部，都得以广泛普及。

公司或家庭接入互联网：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/Chapter1_1_9_%E5%85%AC%E5%8F%B8%E6%88%96%E5%AE%B6%E5%BA%AD%E6%8E%A5%E5%85%A5%E4%BA%92%E8%81%94%E7%BD%91.png)



## 6. 以互联网技术为中心的时代

许多发展道路各不相同的网络技术也都正在向互联网靠拢。例如，曾经一直作为通信基础设施、支撑通信网络的电话网，随着互联网的快速发展，其地位也随着时间的推移为IP(Internet Protocol)网所取代，而IP网本身就是互联网技术的产物。通过IP网，人们不仅可以实现电话通信、电视播放，还能实现计算机之间的通信，建立互联网。并且，能够联网的设备也不仅限于单纯的计算机，而是扩展到了手机、家用电器、游戏机等许多其他产品。

通过IP协议实现通信、播放的统一

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_10_%E9%80%9A%E8%BF%87IP%E5%8D%8F%E8%AE%AE%E5%AE%9E%E7%8E%B0%E9%80%9A%E4%BF%A1%E3%80%81%E6%92%AD%E6%94%BE%E7%9A%84%E7%BB%9F%E4%B8%80.png)


## 7. 从“单纯建立连接”到“安全建立连接”

这个阶段，人们开始关注互联网的安全性了。

# 协议

简单来说，协议就是计算机与计算机之间通过网络实现通信时事先达成的一种“约定”。这种“约定”使那些由不同厂商的设备、不同的CPU以及不同的操作系统组成的计算机之间，只有遵循相同的协议就能够实现通信。反之，如果所使用的协议不同，就无法实现通信。这就好比两个人使用不同国家的语言说话，怎么也无法相互理解。协议可以分为很多种，每一种协议都明确地界定了它的行为规范。两台计算机之间必须能够支持相同的协议，并遵循相同协议进行处理，这样才能实现相互通信。

协议如同人与人对话：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_11_%E5%8D%8F%E8%AE%AE%E5%A6%82%E5%90%8C%E4%BA%BA%E4%B8%8E%E4%BA%BA%E7%9A%84%E5%AF%B9%E8%AF%9D.png)

在计算机通信中，事先达成一个详细的约定，并遵循这一约定进行处理尤为重要。这种约定其实就是“协议”：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_12_%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE.png)

# 分组交换协议

分组交换是指将大数据分割为一个个叫做包(Packet)的较小单位进行传输的方法。这里所说的包，如同我们平常在邮局里见到的邮包。分组交换就是将大数据分装为一个个这样的包交给对方。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_13_%E5%88%86%E7%BB%84%E9%80%9A%E4%BF%A1.png)

当人们邮寄包裹时，通常会填写一个寄件单贴到包裹上再交给邮局。寄件单上一般会有寄件人和收件人的详细地址。类似地，计算机通信也会在每一个分组中附加上源主机地址和目标主机地址送给通信线路。这些 **发送端地址** 、**接收端地址** 以及 **分组序号** 写入的部分称为“**报文首部**”。

一个较大的数据被分为多个分组时，为了标明是原始数据中的哪一部分，就有必要将分组的序号写入包中。接收端会根据这个序号，再将每个分组按照序号重新装配为原始数据。

通信协议中，通常会规定报文首部应该写入哪些信息、应该如何处理这些信息。相互通信的每一台计算机则根据协议构造报文首部、读取首部内容等。为了双方能正确通信，分组的发送方和接收方有必要对报文首部和内容保持一致的定义和解释。

# 协议由谁规定

在计算机通信诞生之初，每家计算机厂商都出产各自的网络产品来实现计算机通信。这样就形成了很多的协议：

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_14_%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%A0%87%E5%87%86%E5%8C%96.png)

为了解决上述问题，ISO(International Organization for Standards,国际标准化组织)制定了一个国际标准OSI(Open Systems Interconnection,开放式通信系统互联参考模型)，对通信系统进行了标准化。

# 协议分层与OSI参考模型

OSI模型将通信协议中必要的功能分成了7层，每个分层都接收由它下一层所提供的特定服务，并且负责为自己的上一层提供特定的服务。上下曾之间进行交互时所遵循的约定叫做“接口”。同一层之间的交互所遵循的约定叫做“协议”。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_15_%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%88%86%E5%B1%82.png)


# OSI参考模型中各个分层的作用

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_16_OSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B%E5%90%84%E5%B1%82%E5%88%86%E5%B7%A5_1.png)
![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_17_OSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B%E5%90%84%E5%B1%82%E5%88%86%E5%B7%A5_2.png)


## 应用层

为应用程序提供服务并规定应用程序中通信相关的细节。包括文件传输、电子邮件、远程登录等协议。

## 表示层

将应用处理的信息转换为适合网络传输的格式，或将来自下一层的数据转换为上层能够处理的格式。因此它主要负责数据格式的转换。

具体来说，就是将设备固有的数据格式转换为网络标准传输格式。不同设备对同一比特流解释的结果可能会不同。因此，使他们保持一致是这一层的主要作用。

## 会话层

负责建立和断开通信连接，以及数据的分割等数据传输相关的管理。

## 传输层

起着可靠传输的作用。只在通信双方节点上进行处理，而无序在路由器上处理。

## 网络层

将数据传输到目标地址。目标地址可以是多个网络通过路由器连接而成的某一个地址。因此这一层主要负责寻址和路由选择。

## 数据链路层

负责物理层面上互连的、节点之间的通信传输。将0、 1序列划分为具有意义的数据帧传送给对端(数据帧的生成与接收)。

## 物理层

负责0 、 1比特流(0 、 1序列)与电压的高低、光的闪灭之间的互换。



> TCP/IP协议中，传输层负责数据传输的可靠性，网络层负责数据在网络之间传播。

# 传输方式的分类

## 面向有连接型与面向无连接型

通过网络发送数据，大致可以分为面向有连接与面向无连接两种类型。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_18_%E9%9D%A2%E5%90%91%E6%9C%89%E8%BF%9E%E6%8E%A5%E5%9E%8B%E4%B8%8E%E9%9D%A2%E5%90%91%E6%97%A0%E8%BF%9E%E6%8E%A5%E5%9E%8B.png)

### 面向有连接型

面向有连接型中，在发送数据之前，需要在收发主机之间连接一条通信线路

### 面向无连接型

面向无连接型则不需要建立连接和断开连接。发送端可于任何时候自由发送数据。不需要确认对端是否存在。即使接收端不存在或无法接收数据，发送端也能将数据发送出去。


## 电路交换与分组交换

在电路交换中，交换机主要负责数据的中专处理。计算机首先被连接的交换机上，而交换机与交换机之间则由众多通信线路再继续连接。因此计算机之间在发送数据时，需要通过交换机与目标主机建立通信电路。我们将连接电路称为 **建立连接** 。简历好连接一号，用户就可以移植使用这条电路，直到该连接被断开为止。  
如果某条电路只是用来连接两台计算机的通信线路，就意味着只需在这两台计算机之间实现通信，因此这两台计算机是可以独占线路进行数据传输的。但是，如果一条点路上连接了多台计算机，而这些计算机之间需要相互传递数据，就会出现问题。鉴于一台计算机在收发信息时会独占整个电路，其他计算机只能等待这台计算机处理结束以后才有机会使用这条电路首发数据。并且在此过程中，谁也无法预测某一台计算机的数据传输从何时开始又在何时结束。如果并发用户数超过交换机之间的通信线路数，就意味着通信根本无法实现。  
为此，人们想到了一个新的方法，即让连接到通信电路的计算机将所要发送的数据分成多个数据包，按照一定的顺序排列之后分别发送。这就是分组交换。有了分组交换，数据被细分后，所有的计算机就可以一齐收发数据，这样也就提高了通信线路的利用率。由于在分组的过程中，已经在每个分组的首部写入了发送端和接收端的地址，所以即使同一条线路同时为多个用户提供服务，也可以明确区分每个分组数据发往的目的地，以及它是与哪台计算机进行的通信。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_19_%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2.png)


# 地址

## 地址的唯一性

一个地址必须明确地表示一个主体对象。在同一个通信网络中不允许有两个相同地址的通信主体存在，这就是地址的唯一性。

## 地址的层次性

当地址总数并不是很多的情况下，有了唯一地址就可以定位相互通信的主体。然而，当地址的总数越来越多时，如何高效地从中找出通信的目标地址将成为一个重要的问题。地址除了具有唯一性还需要具有层次性，正是有了这种层次分类才能更加快速地定位某一个地址。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_20_%E5%9C%B0%E5%9D%80%E7%9A%84%E5%88%86%E5%B1%82.png)

IP地址又是怎样实现分层的呢？一方面，IP地址由网络号和主机号两部分组成。即使通信主体的IP地址不同，若主机号不同，网络号相同，说明它们处于同一个网段。通常，同处一个网段的主机也都术语同一个部门或集团组织。另一方面，网络号相同的主机在组织结构、提供商类型和低于分布上都比较集中，也为IP寻址带来了极大的方便。这也是为什么说IP地址具有层次性的原因。



# 网络的构成要素

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_21_%E7%BD%91%E7%BB%9C%E6%9E%84%E6%88%90%E8%A6%81%E7%B4%A0.png)

| 设备 | 作用 |
| :------------- | :------------- |
| 网卡 | 使计算机联网的设备(Network Interface) |
| 中继器(Repeater)|从物理层上延长网络的设备
|网桥(Bridge)  /2层交换机| 从数据链路层上延长网络的设备
|路由器(Router)  /3层交换机| 通过网络层转发分组数据的设备
|4~7层交换机| 处理传输层以上各层网络传输的设备
|网关(Gateway)|转换协议的设备

## 网卡

任何一台计算机链接网络时，必须要使用网卡(全称为网络接口卡NIC)。

## 中继器

中继器(Repeater)是在OSI模型的第1层——物理层面上延长网络的设备。由电缆传过来的电信号或光信号经由中继器的波形调整和放大再传给另一个电缆。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_22_%E4%B8%AD%E7%BB%A7%E5%99%A8.png)

有些中继器可以提供多个端口服务。这种中继器被称作中继器集线器或 **集线器** 。因此，集线器也可以看作是多口中继器，每个端口都可以成为一个中继器。

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_23_%E9%9B%86%E7%BA%BF%E5%99%A8.png)

## 网桥/2层交换机

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_24_%E7%BD%91%E6%A1%A5.png)

网桥在OSI模型的第2层——数据链路层面上链接两个网络的设备。它能够识别数据链路层中的数据帧，并将这些数据帧临时存储于内存，再重新生成信号作为一个全新的帧转发给相连的另一个网段。

数据链路的数据帧中有一个数据位叫做FCS，用以检验数据是否正确送达目的地。网桥通过检查这个域中的值，将那些损坏的数据丢弃，从而避免发送给其他的网段。


## 路由器/3层交换机

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_25_%E8%B7%AF%E7%94%B1%E5%99%A8.png)

路由器是在OSI模型的第3层——网络层面上连接两个网络、并对分组报文进行转发的设备。网桥是根据物理地址(MAC地址)进行处理，而路由器/3层交换机则是根据IP地址进行处理的。由此，TCP/IP中网络层的地址就成为了IP地址。

## 4~7层交换机

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_26_4%EF%BD%9E7%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA.png)

4~7层交换机负责处理OSI模型中从传输层至应用层的数据。如果用TCP/IP分层模型来表述，4~7层交换机就是TCP等协议的传输层及其上面的应用层为基础，分析收发数据，并对其进行特定的处理。

例如，对于并发访问量非常大的一个企业级Web站点，使用一台服务器不足以满足前端的访问需求，这时通常会架设多台服务器来分担。这些服务器前端访问的入口地址通常只有一个(企业为了使用者的方便，只会向最终用户开放一个统一的访问URL)。为了能通过同一个URL将前端访问分发到后台多个服务器上，可以在这些服务器的前端加一个负载均衡器。这种负载均衡器就是4~7层交换机的一种。


## 网关

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_27_%E7%BD%91%E5%85%B3.png)

网关是OSI参考模型中负责将从传输层到应用层的数据进行转换和转发的设备。它与4~7层交换机一样都是处理传输层及以上的数据，但是网关不仅转发数据还负责对数据进行转换，它通常会使用一个表示层或应用层网关，在两个不能进行直接通信的协议之间进行翻译，最终实现两者之间的通信。  
一个非常典型的例子就是互联网邮件与手机邮件之间的转换服务。手机邮件有时可能会与互联网邮件互不兼容，这是由于它们在表示层和应用层这的“电子邮件协议”互不相同所导致的。   
那么，为什么连到互联网的电脑与手机之间能够互发电子邮件呢？如下图所示， 互联网与手机之间设置了一道网关。网关负责读取完各种不同的协议后，对它们逐一进行合理的转换，再将相应的数据转发出去。这样一来即使应用的是不同电子邮件的协议，计算机与手机之间也能互相发送邮件。


![](https://raw.githubusercontent.com/JerryIreya/Image/master/图解TCP-IP/Chapter01/1_28_手机与互联网电子邮件的转换.png)

## 各种设备及其对应网络分层概览

![](https://raw.githubusercontent.com/JerryIreya/Image/master/%E5%9B%BE%E8%A7%A3TCP-IP/Chapter01/1_29_%E5%90%84%E7%A7%8D%E8%AE%BE%E5%A4%87%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E6%A6%82%E8%A7%88.png)
